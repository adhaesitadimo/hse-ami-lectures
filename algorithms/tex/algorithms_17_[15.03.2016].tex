\input{header.tex}

\begin{document}

\section*{Лекция ?? от 15.03.2016}

\subsection{?}

Пусть у нас есть некоторая функция Init$(n)$, создающая массив из $n$ нулей;
Read$(i)$;
Write$(a, i)$

Также будем исходить из предположения, что памядь под $n$ элементов можно выделить за время $O(1)$; чтение и запись тоже будем считать константными.

Соответственно Init$(n)$ работает за линейное время --- выделение за константу и $n$ присваиваний. А если мы хотим инициализацию тоже за константу?

Давайте сдеаем так --- не будем ничего хранить, пока не надо, а когда будет запрос в ранее незанятую ячейку, возвращать ноль.

Перепишем наш Read:

\begin{lstlisting}
Read(i)
    if IsInitialized(i) then
        return A[i]
    else return 0
\end{lstlisting}

\begin{lstlisting}
IsInitialized(i)
    if B[i] > k then 
        return False
    if C[B[i]] = i then
        return True
    else return False
\end{lstlisting}

\begin{lstlisting}
Write(a, i)
    A[i] := a
    if not IsInit(i)
        k := k+1
        B[i] := k
        C[k] := 1
\end{lstlisting}

\begin{lstlisting}
Init(m)
    A := Malloc(n)
    B := Malloc(n)
    C := Malloc(n)
    k := 0
\end{lstlisting}

\subsection{??}

Пусть у нас есть восьмибитное число 0; будем прибавлять к нему единицу. Заметим, что в первый раз понадобится одна операция, потом две, потом одна, потом три\ldots

Получается, что инкремент имеет сложность $O(k)$; логично предположить, что $n$ инкрементов --- $O(nk)$. Это действительно так, но это грубая оценка --- $O(k)$ ведь только в худшем случае.

\begin{lstlisting}
Increment(A)
    for i := 0 to k-1 do
        if A[i] = 0 then
            A[i] := 1
            break
        A[i] = 0
\end{lstlisting}

Заметим, что при $n$ инкрементах последний знак числа меняется $n$ раз, предпоследний --- $\frac{n}{2}$ и так далее.В сумме это составит не более $2n$ изменений ---$O(n)$.

\subsection{Банковский метод}.

$c_i$ --- реальная стоимость

$\hat c_i$ --- учётная стоимость.

$\sum \hat c_i \geqslant \sum c_i$ --- вчёт всегда больше 0.

Если $\hat c_i > c_i$ то разность поступает на счёт, иначе списывается.

При этом учётная стоимость является оценкой сверху для реальности.

В нашей задаче с инкрементом введём такие стоимости:

$\hat c (0\to 1) = 2;\ c (1\to 0) = 0$ 

Учётная стоимость одного инкремента не больше двух.

\subsection{Метод потенциалов}

$D_i$ --- структура данных после $i$ операций.

$\Phi(D_0) = 0$

$\Phi(D_i) \geqslant 0$

$\hat c_i := c_i + \Phi(D_i) - \Phi(D_{i-1})$

$\sum\limits_{i=1}^n\hat c_i = \sum\limits_{i=1}^n c_i +\Phi(D_n) - \Phi(D_0)$

Пусть $\Phi(D_i)$ --- количество единиц.

$\hat c_i = c_i + \Phi(D_i) - \Phi(D_{i-1}) \leqslant t+1+1-t = 2$

\end{document}
