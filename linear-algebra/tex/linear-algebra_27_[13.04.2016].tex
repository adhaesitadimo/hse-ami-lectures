\input{header.tex}

\begin{document}
\renewcommand{\f}{\mathbb{f}}

\section{Лекция 27 от 13.04.2016}

\subsection*{Привидение к каноническому и нормальному виду}

Пусть $V$ --- векторное пространство, $\dim V = n$, $\e = \vector{e}$ --- базис $V$, $Q \colon V \rightarrow F$ --- квадратичная функция на $V$.

\begin{Theorem}
Для любой квадратичной функции $Q$ существует такой базис, в котором $Q$ имеет канонический вид.
\end{Theorem}

\begin{proof} Метод Лагранжа.

Докажем индукцией по $n$.

При $n = 1$ имеем, что $Q(x) = ax^2$, то есть уже имеем канонический вид.

Предположим, что для всех значений меньших $n$ доказано. Докажем тогда для $n$.

Пусть $A = (a_{ij})$ --- матрица квадратичной функции $Q$ в исходном базисе. Тогда:
$$
Q(x) = Q(x_1, \ldots, x_n) = \sum_{i = 1}^{n}a_{ii}x_i^2 + 2\sum_{1 \leqslant i < j \leqslant n}a_{ij}x_ix_j
$$

\underline{Случай 0}: пусть $a_{ij} = 0$ для всех пар $(i, j)$. Тогда $Q(x) = 0x_1^2 + \ldots + 0x_n^2$ --- уже канонический вид.

\underline{Случай 1}: пусть существует такое $i$, что $a_{ii} \neq 0$. Перенумеровав переменные, считаем, что $a_{11} \neq 0$. Тогда:
\begin{gather*}
Q(x_1, \ldots, x_n) = (a_{11}x_1^2 + 2a_{12}x_1x_2 + \ldots + 2a_{1n}x_1x_n) + Q_1(x_2, \ldots, x_n) = \\
= \frac{1}{a_{11}}\left((a_{11}x_1 + \ldots + a_{1n}x_n)^2 - (a_{12}x_2 + \ldots + a_{1n}x_n)^2  \right) + Q_1(x_2, \ldots, x_n) = \\
= \frac{1}{a_{11}}(a_{11}x_1 + \ldots + a_{1n}x_n)^2 + Q_2(x_2, \ldots, x_n) 
\end{gather*}
Теперь сделаем следующую замену переменных:
\begin{gather*}
x_1' = a_{11}x_1 + \ldots + a_{1n}x_n \\
x_2' = x_2, \ldots, x_n' = x_n
\end{gather*}
Получаем:
$$
Q(x_1', \ldots, x_n') = \frac{1}{a_{11}}x_1' + Q_2(x_2', \ldots, x_n')
$$
Дальше пользуемся предположением индукции для $Q_2$, окончательно получая канонический вид для исходной $Q$.

\underline{Случай 2}: пусть $a_{ii} = 0$ для всех $i$, но существует такая пара $(i, j)$, где $i < j$, что $a_{ij} \neq 0$. Переименовываем переменные так, чтобы $a_{12} \neq 0$ и делаем замену:
\begin{gather*}
x_1 = x_1' - x_2' \\
x_2 = x_1' + x_2' \\
x_3 = x_3', \ldots, x_n = x_n'
\end{gather*}
Тогда $2a_{12}x_1x_2 = 2a_{12}x_1'^2 - 2a_{12}x_2'^2$. Следовательно:
$$
Q(x_1', \ldots, x_n') = 2a_{12}x_1'^2 - 2a_{12}x_2'^2 + 2\sum_{1 \leqslant i < j \leqslant n}a_{ij}x_i'x_j'
$$
Таким образом, мы пришли к случаю 1, который уже умеем решать.
\end{proof}

\begin{Consequence}
Всякую квадратичную функцию над полем $\R$ можно заменой базиса привести к нормальному виду.
\end{Consequence}

\begin{proof}
Существует такой базис, в котором $Q(x_1, \ldots, x_n) = a_1x_1^2 + \ldots + a_nx_n^2$. Сделаем замену:
$$
x_i' = 
\begin{cases}
\sqrt{|a_i|}x_i, & \text{если } a_i \neq 0 \\
x_i, & \text{если } a_i = 0
\end{cases}
$$
Второе условие нужно для того, чтобы можно было выразить старые переменные через новые, не деля при этом на ноль.

Получаем, что $Q(x_1', \ldots, x_n') = \epsilon_1x_1'^2 + \ldots + \epsilon_nx_n'^2$, где $\epsilon_i = \sgn a_i \in \{-1, 0, 1\}$. Что нам и было надо.
\end{proof}

\begin{Comment}
Если $F = \C$, то любую квадратичную функцию $Q$ можно привести к виду $Q(x_1, \ldots, x_n) = x_1^2 + \ldots + x_k^2$, где $k \leqslant n$ ($k = \rk Q$), то есть $B(Q, \e) = \diag(1, \ldots, 1, 0, \ldots, 0)$.
\end{Comment}

\subsection*{Закон инерции, индексы инерции}

Пусть $Q$ --- квадратичная функция над $\R$, которая в базисе $\e$ имеет нормальный вид: 
$$
Q(x_1, \ldots, x_n) = x_1^2 + \ldots + x_s^2 - x_{s + 1}^2 - \ldots - x_{s + t}^2,
$$
где $s$ --- это количество положительных слагаемых, а $t$ --- отрицательных.

\begin{Theorem}[Закон инерции]
Числа $s,\ t$ не зависят от выбора базиса, в котором $Q$ имеет нормальный вид.
\end{Theorem}

\begin{proof}
Пусть $\e = \vector{e}$ --- базис такой, что $v = x_1e_1 + \ldots + x_ne_n$ и $Q$ имеет в нем нормальный вид: $Q(v) = x_1^2 + \ldots + x_s^2 - x_{s + 1}^2 - \ldots - x_{s + t}^2$. 

Пусть также $\f = \vector{f}$ --- другой базис такой, что $v = y_1e_1 + \ldots + y_ne_n$ и $Q$ также имеет в нем нормальный вид: $Q(v) = y_1^2 + \ldots + y_p^2 - y_{p + 1}^2 - \ldots - y_{p + q}^2$.

Заметим, что $s + t = p + q$, так как обе эти суммы равны $\rk Q$. В допущении, что $s \neq p$, не умоляя общности будем считать, что $s > p$.

Положим $L_1 = \langle e_1, \ldots, e_s \rangle,\ \dim L_1 = s$ и $L_2 = \langle f_{p + 1}, \ldots, f_{n}\rangle,\ \dim L_2 = n - p$. Видно, что $L_1 + L_2 \subset V$, а значит, $\dim(L_1 + L_2) \leqslant n$. Тогда:
$$
\dim(L_1 \cap L_2) = \dim L_1 + \dim L_2 - \dim(L_1 + L_2) \geqslant s + n - p - n = s - p > 0.
$$
Следовательно, существует ненулевой вектор $v \in L_1 \cap L_2$. Разложим тогда этот вектор в базисах данных линейных оболочек:
\begin{gather*}
v = x_1e_1 + \ldots + x_se_s,\ \exists x_i \neq 0 \Rightarrow Q(v) = x_1^2 + \ldots + x_s^2 >0 \\
v = y_{p + 1}f_{p + 1} + \ldots + y_nf_n \Rightarrow Q(v) = -y_{p+1}^2 - \ldots - y_{p + q}^2 \leqslant 0
\end{gather*}

Получили противоречие. Значит, исходное предположение неверно и $s = p$. Откуда в свою очередь следует, что $t = q$.
\end{proof}

\begin{Def}
Эти числа имеют свои названия:
\begin{enumerate}
\item $i_+ := s$ --- положительный индекс инерции;
\item $i_- := t$ --- отрицательный индекс инерции;
\item $i_0 := n - s - t$ --- нулевой индекс инерции.
\end{enumerate}
\end{Def}

\begin{Def}
Квадратичная функция $Q$ над полем $\R$ называется
\begin{center}
\begin{tabular}{c|c|c}
Термин                      & Обозначение     & Условие \\ \hline
положительно определенной   & $Q > 0$         & $Q(x) > 0\ \forall x \neq 0$ \\
отрицательно определенной   & $Q < 0$         & $Q(x) < 0\ \forall x \neq 0$ \\
неотрицательно определенной & $Q \geqslant 0$ & $Q(x) \geqslant 0\ \forall x$ \\
неположительно определенной & $Q \leqslant 0$ & $Q(x) \leqslant 0\ \forall x$ \\
неопределенной              & $-$             & $\exists x, y \colon Q(x) > 0,\ Q(y) < 0$
\end{tabular}

\begin{tabular}{c|c|c}
Термин                      & Нормальный вид                                                      & Индексы инерции \\ \hline
положительно определенной   & $x_1^2 + \ldots + x_n^2$                                            & $i_+=n,\ i_- = 0$ \\
отрицательно определенной   & $-x_1^2 - \ldots - x_n^2$                                           & $i_+=0,\ i_-=n$ \\
неотрицательно определенной & $x_1^2 + \ldots + x_k^2,\ k \leqslant n$                            & $i_+=k,\ i_-=0$ \\
неположительно определенной & $-x_1^2 - \ldots - x_k^2,\ k \leqslant n$                           & $i_+=0, i_-=k$ \\
неопределенной              & $x_1^2+\ldots+x_s^2-x_{s + 1}^2-\ldots-x_{s + t}^2,\ s,t\geqslant1$ & $i_+=s,\ i_-=t$
\end{tabular}
\end{center}
\end{Def}

\begin{Examples} $V = \R^2$.
\begin{enumerate}
\item $Q(x, y) = x^2 + y^2,\ Q > 0$;
\item $Q(x, y) = - x^2 - y^2,\ Q < 0$;
\item $Q(x, y) = x^2 - y^2$;
\item $Q(x, y) = x^2,\ Q \geqslant 0$;
\item $Q(x, y) = -x^2,\ Q \leqslant 0$.
\end{enumerate}
\end{Examples}
\end{document}