\input{header.tex}

\begin{document}
\section{Лекция 26 от 06.04.2016}

\subsection*{Матрицы билинейных функций}
Пусть $V$ --- векторное пространство, $\dim V < \infty$, $\beta \colon V \times V \rightarrow F$ --- билинейная функция.

\begin{Def}
Матрицей билинейной функции в базисе $\e$ называется матрица $B = (b_{ij})$, где $b_{ij} = \beta(e_i, e_j)$. Обозначение: $B(\beta, \e)$.
\end{Def}

Пусть $x = x_1e_1 + \ldots + x_ne_n \in V$ и $y = y_1e_1 + \ldots + y_ne_n \in V$. Тогда:
\begin{gather*}
\beta(x, y) = \beta\left(\sum_{i = 1}^{n}x_ie_i, \sum_{j = 1}^{n}y_je_j\right) = \sum_{i = 1}^{n} x_i\beta\left(e_i, \sum_{j = 1}^{n}y_je_j\right) = \\
= \sum_{i = 1}^{n}x_i\sum_{j = 1}^{n}y_j\beta(e_i, e_j) = \sum_{i = 1}^{n}\sum_{j = 1}^{n}x_ib_{ij}y_j = \\
= (x_1, \ldots, x_n)B \vvector{y} \quad (*)
\end{gather*}

\begin{Suggestion}\
\begin{enumerate}
\item Всякая билинейная функция однозначно определяется своей матрицей в базисе $\e$ (и, следовательно, в любом другом базисе).
\item Для любой матрицы $B \in M_n(F)$ существует единственная билинейная функция $\beta$ такая, что $B = B(\beta, \e)$.
\end{enumerate}
\end{Suggestion}

\begin{proof}\
\begin{enumerate}
\item Уже доказано, это следует из формулы $(*)$.
\item Определим $\beta$ по формуле $(*)$. Тогда $\beta$ --- это билинейная функция на $V$ и ее матрица есть в точности $B$. Единственность следует из все той же формулы.
\end{enumerate}
\end{proof}

\begin{Comment}
Эта биекция не имеет никакого отношения к биекции линейных операторов с квадратными матрицами.
\end{Comment}

Пусть $\e = (e_1, \ldots, e_n)$ и $\e' = (e'_1, \ldots, e'_n)$ --- два базиса $V$, $\beta$ --- билинейная функция на $V$. Пусть также $\e' = \e C$, где $C$ --- матрица перехода, также $B(\beta, \e) = B$ и $B(\beta, \e') = B'$.

\begin{Suggestion}
$B' = C^TBC$.
\end{Suggestion}

\begin{proof}
Рассмотрим представление вектора $x \in V$ в обоих базисах.
\begin{gather*}
\begin{aligned}
x = x_1e_1 + \ldots + x_ne_n = (e_1, \ldots, e_n)\vvector{x} \\
x = x'_1e'_1 + \ldots + x'_ne'_n = (e'_1, \ldots, e'_n) \vvector{x'}
\end{aligned}
\Longrightarrow
\vvector{x} = C\vvector{x'}
\end{gather*}
Аналогично для $y \in V$:
\begin{gather*}
\begin{aligned}
y = (e_1, \ldots, e_n)\vvector{y} \\
y = (e'_1, \ldots, e'_n) \vvector{y'}
\end{aligned}
\Longrightarrow
\vvector{y} = C\vvector{y'}.
\end{gather*}
Тогда,  если мы транспонируем формулу для $x$, получаем:
$$
\beta(x, y) = \vector{x}B\vvector{y} = \vector{x'}C^TBC\vvector{y'}.
$$
Одновременно с этим:
$$
\beta(x, y) = \vector{x'}B'\vvector{y'}.
$$
Сравнивая эти две формулы, получаем, что $B' = C^TBC$.
\end{proof}

\begin{Consequence}
Число $\rk B$ не зависит от выбора базиса.
\end{Consequence}

\begin{Def}
Число $\rk B$ называется рангом билинейной функции $\beta$. Обозначение: $\rk \beta$.
\end{Def}

\subsection*{Симметричные билинейные функции}

Как и для линейных операторов, неплохо было бы научиться находить такой базис, в котором матрица $B$ была бы проще. Но мы это сделаем только для некоторого класса билинейных функций.

\begin{Def}
Билинейная функция называется симметричной, если $\beta(x, y) =\beta(y, x)$ для любый $x, y \in V$.
\end{Def}

\begin{Suggestion}
Билинейная функция $\beta$ симметрична тогда и только тогда, когда матрица $B(\beta, \e)$ --- симметрическая (т.е. она равна своей транспонированной).
\end{Suggestion}

\begin{proof}
Пусть $B = B(\beta, \e)$.
\begin{itemize}
\item[$\Rightarrow$] $\beta(e_i, e_j) = b_{ij} = b_{ji} = \beta(e_j, e_i) \Rightarrow B$ симметрична. 
\item[$\Leftarrow$] Пусть $x = x_1e_1 + \ldots x_ne_n$ и $y = y_1e_1 + \ldots + y_ne_n$. Также воспользуемся тем, что данная нам матрица симметрична, то есть равна своей транспонированной.
\begin{gather*}
\beta(y, x) = \vector{y}B\vvector{x} = \left[\vector{y}B\vvector{x}\right]^T =\\
= \vector{x}B^T\vvector{y} = \vector{x}B\vvector{y} = \beta(x, y)
\end{gather*}
То есть $\beta(y, x) = \beta(x, y)$, что и означает, что $\beta$ симметрична.
\end{itemize}
\end{proof}

\subsection*{Квадратичные функции}

\begin{Def}
Пусть $\beta \colon V\times V \rightarrow F$ --- билинейная функция. Тогда $Q_\beta \colon V \rightarrow F$, заданная формулой $Q_\beta(x) = \beta(x, x)$, называется квадратичной функцией (формой), ассоциированной с билинейной функцией $\beta$.
\end{Def}

Покажем, что такая квадратичная функция на самом деле является однородным многочленом степени 2 от $n$ переменных. Пусть $\e = \vector{e}$ --- базис $V$, $B = B(\beta, \e)$, $x = \vector{x}$. Тогда:
$$
Q_\beta(x) = \vector{x}V\vvector{x} = \sum_{i = 1}^{n}\sum_{j = 1}^{n}b_{ij}x_ix_j
$$

Квадратичную функцию удобно так представлять, но не определять.

\begin{Examples}
Здесь $\e$ --- стандартный базис.
\begin{enumerate}
\item $V = \R^n,\ \beta(x, y) = x_1y_1 + \ldots + x_ny_n\ \Rightarrow\ Q_\beta(x) = x_1^2 + \ldots + x_n^2,\ B(\beta, \e) = E$.
\item $V = \R^2,\ \beta(x, y) = 2x_1y_2\ \Rightarrow\ Q_\beta(x) = 2x_1x_2,\ B(\beta, \e) = \begin{pmatrix}0 & 2 \\ 0 & 0\end{pmatrix}$.
\item $V=\R^2,\ \beta(x, y) = x_1y_2+x_2y_1\ \Rightarrow\ Q_\beta(x) = 2x_1x_2,\ B(\beta, \e) = \begin{pmatrix}0 & 1 \\ 1 & 0\end{pmatrix}$.
\end{enumerate}
\end{Examples}

\begin{Comment}
Квадратичная функция задает билинейную функцию не однозначно (примеры 2 и 3).
\end{Comment}

В дальнейшем нам понадобится делить на два. Поэтому далее предположим, что в нашем поле $F$ можно делить на два. Что это означает? Заметим, что $2 = 1 + 1$, и, строго говоря, нельзя делить на ноль. Следовательно, наше условие можно переформулировать: рассматриваем такие поля $F$, в которых $1 + 1 \neq 0$. В терминах поля, это уже гораздо более осмысленное и понятное условие.

\begin{Theorem}
Отображение $\beta \mapsto Q_\beta$ является биекцией между симметричными билинейными функциями на $V$ и квадратичными функциями на $V$.
\end{Theorem}

\begin{proof}\ \\
\underline{Суръективность.} Пусть $\beta$ --- билинейная функция. Рассмотрим тогда ассоциированную с ней квадратичную функцию $Q_\beta(x) = \beta(x, x)$. Пусть $\sigma(x, y) = \frac{1}{2}(\beta(x, y) + \beta(y, x))$ --- симметричная билинейная функция на $V$. Тогда:
$$
Q_\sigma(x) = \sigma(x, x) = \frac{1}{2}(\beta(x, x) + \beta(x, x)) = \beta(x, x) = Q_\beta(x)
$$
Итого, $Q_\sigma = Q_\beta$. Следовательно, отображение суръективно.

\underline{Инъективность}. Пусть $\beta(x, y)$ -- симметричная билинейная функция. Аналогично, рассмотрим $Q_\beta(x) = \beta(x, x)$. Посмотрим на $Q_\beta(x + y)$:
\begin{gather*}
Q_\beta(x + y) = \beta(x + y, x + y) = \beta(x, x) + \beta(x, y) + \beta(y, x) + \beta(y, y) = Q_\beta(x) + Q_\beta(y) + 2\beta(x, y) \\
\Downarrow \\
\beta(x, y) = \frac{1}{2}\left( Q_\beta(x + y) - Q_\beta(x) - Q_\beta(y)  \right)
\end{gather*}
Полученная выше формула как раз и означает, что значения билинейной функции однозначно задаются соответствующей квадратичной функцией.
\end{proof}

\begin{Comment}\
\begin{enumerate}
\item Билинейная функция $\sigma(x, y) = \frac{1}{2}(\beta(x, y) + \beta(y, x))$ называется симметризацией билинейной функции $\beta$. Причем если $B = B(\beta, \e)$ и $S = B(\sigma, \e)$, то $S = \frac{1}{2}(B + B^T)$.
\item Симметричная билинейная функция $\beta(x, y) = \frac{1}{2}\left( Q_\beta(x + y) - Q_\beta(x) - Q_\beta(y)  \right)$ называется поляризацией квадратичной функции $Q$.
\end{enumerate}
\end{Comment}

\begin{Examples}
Для предыдущих двух примеров:
$$
\begin{pmatrix}
0 & 1 \\
1 & 0
\end{pmatrix} = \frac{1}{2}\left(
\begin{pmatrix}
0 & 2 \\
0 & 0
\end{pmatrix}
+ 
\begin{pmatrix}
0 & 2 \\
0 & 0
\end{pmatrix}^T
\right)
$$
\end{Examples}

Далее вся терминология для билинейных функций переносится на квадратичные функции.

Теперь вспоминаем, что перед нами стоит задача научиться приводить к хорошему виду.

\begin{Def}
Квадратичная функция $Q$ имеет в базисе $\e$ канонический вид, если для любого вектора $x = x_1e_1 + \ldots + x_ne_n$ верно, что $Q_\beta(x) = a_1x_1^2 +\ldots + a_nx_n^2$, где $a_i \in F$. Иными словами, $B(\beta, \e) = \diag(a_1, \ldots, a_n)$.
\end{Def}

\begin{Def}
Квадратичная функция $Q$ имеет нормальный вид в базисе $\e$, если для любого вектора $x = x_1e_1 + \ldots + x_ne_n$ верно, что $Q_\beta(x) = a_1x_1^2 +\ldots + a_nx_n^2$, причем $a_i \in \{-1, 0, 1\}$.  
\end{Def}
\end{document}